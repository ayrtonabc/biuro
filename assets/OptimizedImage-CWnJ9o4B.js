import{R as b,r as s,f as E,j as o}from"./react-vendor-B1Ocs4As.js";import"./vendor-Bf-WtmeY.js";const L=({src:t,alt:g,width:e,height:l,className:f="",loading:h="lazy",priority:y=!1,placeholder:c="empty",blurDataURL:m,...x})=>{const[n,v]=s.useState(!1),[r,p]=s.useState(m||void 0),[j,S]=s.useState(!0),{ref:z,inView:d}=E({triggerOnce:!0,threshold:.01,rootMargin:"200px"});s.useEffect(()=>{if(!d)return;const i=new window.Image,a=()=>{v(!0),S(!1),r!==t&&p(t)};return i.src=t,i.onload=a,i.complete&&i.naturalWidth!==0&&a(),()=>{i.onload=null}},[d,t,r]);const w=s.useMemo(()=>!e||typeof e!="number"?void 0:[{width:Math.round(e*.5),dpr:1},{width:e,dpr:1},{width:Math.round(e*1.5),dpr:1},{width:Math.round(e*2),dpr:2}].map(({width:a,dpr:$})=>{const u=new URL(t);return u.searchParams.set("w",a.toString()),u.searchParams.set("dpr",$.toString()),`${u.toString()} ${a}w`}).join(", "),[t,e]),I=s.useMemo(()=>{if(e)return`(max-width: 768px) 100vw, ${e}px`},[e]),M={opacity:n?1:0,transition:"opacity 0.3s ease-in-out",width:e?"100%":void 0,height:l?"100%":void 0,maxWidth:"100%",display:"block"};return o.jsxs("div",{ref:z,style:{position:"relative",width:e||"100%",height:l||"auto",overflow:"hidden"},className:`optimized-image-container ${f}`,children:[d&&o.jsxs(o.Fragment,{children:[o.jsx("img",{src:r||t,alt:g,width:e,height:l,loading:y?"eager":h,style:M,srcSet:w,sizes:I,decoding:"async",className:`optimized-image ${n?"loaded":"loading"}`,onError:()=>{r!==t&&p(t)},...x}),j&&c==="blur"&&m&&o.jsx("img",{src:m,alt:"",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",filter:"blur(20px)",transform:"scale(1.1)",transition:"opacity 0.3s ease-out",opacity:n?0:1},"aria-hidden":"true"})]}),!n&&d&&c==="empty"&&o.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center"},children:o.jsx("div",{className:"animate-pulse",style:{width:"100%",height:"100%"}})})]})},k=b.memo(L);export{k as default};
